package org.github.log4jexploit.cryptlib;

import java.util.Base64;

public abstract class CryptSymmetric extends CryptWithKey {


    protected CryptSymmetric(int keySize) {
        super(keySize);
    }


    public abstract void generateKey();

    public abstract byte[] encrypt(byte[] data);

    public abstract byte[] decrypt(byte[] data);

    public abstract CryptSymmetricKey exportKey();

    public abstract void importKey(CryptSymmetricKey key);

    static class CryptSymmetricKey {

        private final byte[] key;

        protected CryptSymmetricKey(String encodedKey) {
            this.key = Base64.getDecoder().decode(encodedKey);
        }

        protected CryptSymmetricKey(byte[] key) {
            this.key = key;
        }

        public byte[] getKeyBytes() {
            return key.clone();
        }

        public String getEncoded() {
            return Base64.getEncoder().encodeToString(key);
        }

    }
}
