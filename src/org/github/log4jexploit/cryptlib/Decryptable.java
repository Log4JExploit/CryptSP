/*
 * Author: Log4JExploit
 * Note: This comment can be removed (see in LICENSE file)
 */

package org.github.log4jexploit.cryptlib;

import java.nio.charset.StandardCharsets;
import java.util.Base64;

/**
 * Used for algorithms that both encrypt and decrypt ciphertext
 */
public abstract class Decryptable extends Crypt {

    protected Decryptable(int keySize) {
        super(keySize);
    }

    public abstract byte[] encrypt(byte[] data);

    public abstract byte[] decrypt(byte[] data);

    public String encryptToBase64(String utf8) {
        return Base64.getEncoder().encodeToString(encrypt(utf8.getBytes(StandardCharsets.UTF_8)));
    }

    public String encryptToBase64(byte[] data) {
        return Base64.getEncoder().encodeToString(encrypt(data));
    }

    public String decryptFromBase64ToUTF8(String base64) {
        return new String(decrypt(Base64.getDecoder().decode(base64)), StandardCharsets.UTF_8);
    }

    public byte[] decryptFromBase64(String base64) {
        return decrypt(Base64.getDecoder().decode(base64));
    }
}
