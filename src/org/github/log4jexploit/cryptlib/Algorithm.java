/*
 * Author: Log4JExploit
 * Note: This comment can be removed (see in LICENSE file)
 */

package org.github.log4jexploit.cryptlib;

import java.lang.annotation.*;
import java.util.Arrays;

@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
public @interface Algorithm {

    enum Type { SYMMETRIC, ASYMMETRIC, HASH }

    String name();
    Type type() default Type.SYMMETRIC;
    int[] keySizes();
    String mode() default "This implementation doesn't use a specific cipher mode.";

    class AlgorithmSpec {
        private final Algorithm algorithm;

        protected AlgorithmSpec(Algorithm algorithm) {
            this.algorithm = algorithm;
        }

        @Override
        public String toString() {
            return "Name: "+algorithm.name() + ", Type: "+algorithm.type()+", KeySizes: "+ Arrays.toString(algorithm.keySizes())+", CipherMode: "+ algorithm.mode();
        }
    }
}
